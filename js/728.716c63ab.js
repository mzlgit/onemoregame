"use strict";(self.webpackChunkvue_project=self.webpackChunkvue_project||[]).push([[728],{7728:function(e,t,i){i.r(t),i.d(t,{default:function(){return d}}),i(8409);var s=i(1458),n=i(8570);const o=new s.Pa4;function a(e,t,i,s,n,a){var r=2*Math.PI*n/4;a=Math.max(a-2*n,0),n=Math.PI/4,o.copy(t),o[s]=0,o.normalize(),t=.5*r/(r+a),s=1-o.angleTo(e)/n;return 1===Math.sign(o[i])?s*t:a/(r+a)+t+t*(1-s)}class r extends s.DvJ{constructor(e=1,t=1,i=1,n=2,o=.1){if(n=2*n+1,o=Math.min(e/2,t/2,i/2,o),super(1,1,1,n,n,n),1!==n){var r=this.toNonIndexed(),h=(this.index=null,this.attributes.position=r.attributes.position,this.attributes.normal=r.attributes.normal,this.attributes.uv=r.attributes.uv,new s.Pa4),d=new s.Pa4,c=new s.Pa4(e,t,i).divideScalar(2).subScalar(o),l=this.attributes.position.array,m=this.attributes.normal.array,u=this.attributes.uv.array,p=l.length/6,w=new s.Pa4,M=.5/n;for(let s=0,n=0;s<l.length;s+=3,n+=2)switch(h.fromArray(l,s),d.copy(h),d.x-=Math.sign(d.x)*M,d.y-=Math.sign(d.y)*M,d.z-=Math.sign(d.z)*M,d.normalize(),l[s+0]=c.x*Math.sign(h.x)+d.x*o,l[s+1]=c.y*Math.sign(h.y)+d.y*o,l[s+2]=c.z*Math.sign(h.z)+d.z*o,m[s+0]=d.x,m[s+1]=d.y,m[s+2]=d.z,Math.floor(s/p)){case 0:w.set(1,0,0),u[n+0]=a(w,d,"z","y",o,i),u[n+1]=1-a(w,d,"y","z",o,t);break;case 1:w.set(-1,0,0),u[n+0]=1-a(w,d,"z","y",o,i),u[n+1]=1-a(w,d,"y","z",o,t);break;case 2:w.set(0,1,0),u[n+0]=1-a(w,d,"x","z",o,e),u[n+1]=a(w,d,"z","x",o,i);break;case 3:w.set(0,-1,0),u[n+0]=1-a(w,d,"x","z",o,e),u[n+1]=1-a(w,d,"z","x",o,i);break;case 4:w.set(0,0,1),u[n+0]=1-a(w,d,"x","y",o,e),u[n+1]=1-a(w,d,"y","x",o,t);break;case 5:w.set(0,0,-1),u[n+0]=a(w,d,"x","y",o,e),u[n+1]=1-a(w,d,"y","x",o,t)}}}}var h=i(8423),d=(t=(i(7906),{name:"three2",data(){return{startStatus:!1,timer:null,stopStatus:!1,diceBodyArr:[],sleepItemArr:[],diceCannonSize:{x:.468,y:.468,z:.468},diceCannonPosition:[[0,.5,0],[0,1.5,0],[0,2.5,0],[0,3.5,0],[0,4.5,0]],diceMass:5,diceMesh:null,cannonWorld:null,pushPower:1e3,mouseDown:!1,mouseY:0,mouseMoveY:0,threeRenderer:null,threeScene:null,threeCamera:null,mp3src:i(3020),stopItemArr:[],animationIndex:null}},async mounted(){this.initCannon(),this.initThree(),this.animate();for(let i=0;i<this.diceBodyArr.length;i++){var e=this.diceBodyArr[i],t=this.diceMesh.clone();t.position.copy(e.position),e.sleepTimeLimit=1500,e.addEventListener("sleep",this.sleepyEvent),this.threeScene.add(t),this.cannonWorld.addBody(e),e.sleep()}},methods:{sleepyEvent(){this.startStatus||(this.stopItemArr.push(1),3<=this.stopItemArr.length&&(this.stopStatus=!0))},start(){var e;this.stopStatus&&(this.stopStatus=!1,this.stopItemArr=[],this.startStatus=!0,(e=this.threeScene.children.filter((e=>"topGaper"==e.name))[0]).scale.set(1,1,1),e.position.y=3,this.animate()),this.timer&&clearInterval(this.timer);let t=0;this.timer=setInterval((()=>{this.diceBodyArr.forEach((e=>{e.mass=this.diceMass/2;var i=.5<Math.random()?1:-1;1e3<=t&&(this.startStatus=!1),e.applyForce(new h.AO(i*this.pushPower*Math.random(),i*this.pushPower*Math.random(),i*this.pushPower*Math.random()),e.position)})),1e3<=t?(clearInterval(this.timer),this.diceBodyArr.forEach((e=>{e.mass=2*this.diceMass}))):t+=10}),10)},initCannon(){this.cannonWorld=new h.q3,this.cannonWorld.gravity.set(0,-9.82,0),this.cannonWorld.broadphase=new h.KK,this.cannonWorld.solver.iterations=10;const e=new h.F5("dice");var t=new h.F5("floor");const i=new h.AO(this.diceCannonSize.x,this.diceCannonSize.y,this.diceCannonSize.z);this.diceCannonPosition.forEach((t=>{t=new h.uT({mass:this.diceMass,position:new h.AO(t[0],t[1],t[2]),shape:new h.xu(i),material:e}),this.diceBodyArr.push(t)}));var s=new h.JO,n=new h.uT({mass:0,material:t});n.addShape(s),n.quaternion.setFromEuler(Math.PI/12,Math.PI/2,0,"YXZ"),n.position.set(-2.8,0,0),this.cannonWorld.addBody(n),n=new h.uT({mass:0,material:t}),n.addShape(s),n.quaternion.setFromEuler(Math.PI/12,-Math.PI/2,0,"YXZ"),n.position.set(2.8,0,0),this.cannonWorld.addBody(n),n=new h.uT({mass:0,material:t}),n.addShape(s),n.quaternion.setFromEuler(Math.PI/12,0,0,"YXZ"),n.position.set(0,0,-2.8),this.cannonWorld.addBody(n),n=new h.uT({mass:0,material:t}),n.addShape(s),n.quaternion.setFromEuler(Math.PI/12,Math.PI,0,"YXZ"),n.position.set(0,0,2.8),this.cannonWorld.addBody(n),n=new h.uT({mass:0,material:t}),n.addShape(s),n.quaternion.setFromEuler(Math.PI/12,3*-Math.PI/4,0,"YXZ"),n.position.set(2,0,2.2),this.cannonWorld.addBody(n),n=new h.uT({mass:0,material:t}),n.addShape(s),n.quaternion.setFromEuler(Math.PI/12,3*Math.PI/4,0,"YXZ"),n.position.set(-2,0,2.2),this.cannonWorld.addBody(n),n=new h.uT({mass:0,material:t}),n.addShape(s),n.quaternion.setFromEuler(Math.PI/12,-Math.PI/4,0,"YXZ"),n.position.set(2,0,-2.2),this.cannonWorld.addBody(n),n=new h.uT({mass:0,material:t}),n.addShape(s),n.quaternion.setFromEuler(Math.PI/12,Math.PI/4,0,"YXZ"),n.position.set(-2,0,-2.2),this.cannonWorld.addBody(n),n=new h.uT({mass:0,material:t}),n.addShape(s),n.quaternion.setFromAxisAngle(new h.AO(-1,0,0),.5*-Math.PI),n.position.set(0,5.1,0),this.cannonWorld.addBody(n),n=new h.uT({mass:0,material:t}),n.addShape(s),n.quaternion.setFromAxisAngle(new h.AO(-1,0,0),.5*Math.PI),n.position.set(0,.01,0),this.cannonWorld.addBody(n),s=new h.kp(e,e,{friction:.15,restitution:1}),n=new h.kp(e,t,{friction:.01,restitution:.01});this.cannonWorld.addContactMaterial(s),this.cannonWorld.addContactMaterial(n)},initThree(){this.threeCamera=new s.cPb(75,window.innerWidth/window.innerHeight,.1,1e3),this.threeCamera.position.y=12,this.threeCamera.position.z=8,this.threeCamera.lookAt(0,0,0),this.threeScene=new s.xsS,this.threeScene.background=new s.Ilk(12178431);var e=new s.cek("#fff",.5),t=(e=(e.position.set(0,10,5),e.angle=+Math.PI,e.castShadow=!0,this.threeScene.add(e),new s.Mig("#CfCfCf")),e=(this.threeScene.add(e),new r(1,1,1,5,.2)),new s.Wid({color:"#fff"})),o=(e=(this.diceMesh=new s.Kj0(e,t),this.diceMesh.name="dice",this.diceMesh.castShadow=!0,this.diceMesh.position.y=.5,new s.Wid({color:"red"})),t=new s.Wid({color:"black"}),new s.zf8(1,30)),a=(o.scale(.2,.2,.2),o.translate(0,0,.5009),new s.Kj0(o,e)),h=(a=(this.diceMesh.add(a),o.clone()),o=(a.scale(.5,.5,.5),a.translate(.22,.22,.25),a.rotateY(-Math.PI/2),new s.Kj0(a,t)),t=(this.diceMesh.add(o),o.clone()),t=(t.position.set(0,-.45,-.45),this.diceMesh.add(t),o.clone()),t.rotateZ(Math.PI/2),t.position.set(0,0,-.44),this.diceMesh.add(t),t.clone());h.position.set(.22,0,-.22),this.diceMesh.add(h),h=t.clone(),h.position.set(.44,0,0),this.diceMesh.add(h),t=new s.Kj0(a,e),t.rotateY(Math.PI),this.diceMesh.add(t),h=t.clone(),h.position.set(0,-.44,0),this.diceMesh.add(h),a=t.clone(),a.position.set(0,0,.44),this.diceMesh.add(a),e=t.clone(),e.position.set(0,-.44,.44),this.diceMesh.add(e),h=o.clone(),h.rotateZ(-Math.PI/2),this.diceMesh.add(h),a=h.clone(),a.position.set(-.44,0,0),this.diceMesh.add(a),t=h.clone(),t.position.set(-.44,0,-.44),this.diceMesh.add(t),e=h.clone(),e.position.set(0,0,-.44),this.diceMesh.add(e),a=h.clone(),a.position.set(-.22,0,-.22),this.diceMesh.add(a),t=o.clone(),t.rotateY(-Math.PI/2),t.position.set(.04,0,0),this.diceMesh.add(t),e=t.clone(),e.position.set(.4,0,0),this.diceMesh.add(e),h=t.clone(),h.position.set(.04,-.22,0),this.diceMesh.add(h),a=t.clone(),a.position.set(.4,-.22,0),this.diceMesh.add(a),o=t.clone(),o.position.set(.04,-.44,0),this.diceMesh.add(o),e=t.clone(),e.position.set(.4,-.44,0),this.diceMesh.add(e),this.threeRenderer=new s.CP7({antialias:!0,alpha:!0,logarithmicDepthBuffer:!0}),this.threeRenderer.setPixelRatio(window.devicePixelRatio),this.threeRenderer.setSize(window.innerWidth,window.innerHeight),document.getElementById("three2").appendChild(this.threeRenderer.domElement),h=new n.C(this.threeRenderer),a=new s.anP(this.threeRenderer),this.threeRenderer.shadowMap.enabled=!0,this.threeRenderer.shadowMap.type=s.ntZ,this.threeScene.environment=a.fromScene(h).texture,window.addEventListener("resize",this.onWindowResize),this.threeRenderer.domElement.addEventListener("mousedown",(e=>{this.mouseDown=!0,this.mouseY=e.clientY})),this.threeRenderer.domElement.addEventListener("touchstart",(e=>{this.mouseDown=!0,this.mouseY=e.touches[0].clientY})),this.threeRenderer.domElement.addEventListener("mouseup",(e=>{this.mouseDown=!1,this.mouseY=0,this.mouseMoveY=0})),this.threeRenderer.domElement.addEventListener("touchend",(e=>{this.mouseDown=!1,this.mouseY=0,this.mouseMoveY=0})),this.threeRenderer.domElement.addEventListener("mousemove",(e=>{this.mouseDown&&(this.mouseMoveY=e.clientY,this.oldMouseMoveY=this.mouseMoveY,this.changeTopGaper())})),this.threeRenderer.domElement.addEventListener("touchmove",(e=>{this.mouseDown&&(this.mouseMoveY=e.touches[0].clientY,this.oldMouseMoveY=this.mouseMoveY,this.changeTopGaper())})),o=new s.fHI(3.75,3.4,.15,180),t=new s.xoR({color:"#E9967A"}),e=new s.Kj0(o,t),e.position.y=-.05,e.receiveShadow=!0,this.threeScene.add(e),a=new s.XvJ(3.4,.1,16,100),h=new s.vBJ({color:16776960}),o=new s.Kj0(a,h),o.position.y=0,o.receiveShadow=!0,o.rotateX(274.8901),this.threeScene.add(o),t=new s.fHI(2.9,3.3,6,180),e=new s.xoR({map:(new s.dpR).load(i(5452))}),a=new s.Kj0(t,e);a.position.y=3,a.receiveShadow=!0,a.name="topGaper",this.threeScene.add(a),setTimeout((()=>{this.stopStatus=!0,this.threeRenderer.render(this.threeScene,this.threeCamera)}),350)},onWindowResize(){this.threeCamera.aspect=window.innerWidth/window.innerHeight,this.threeCamera.updateProjectionMatrix(),this.threeRenderer.setSize(window.innerWidth,window.innerHeight)},changeTopGaper(){if(this.mouseDown&&0!==this.mouseMoveY){var e=this.threeScene.children.filter((e=>"topGaper"==e.name))[0];if(this.mouseY<this.mouseMoveY){let t=.05*(this.mouseMoveY-this.mouseY);if(t==e.position.y)return;t=e.position.y-t;let i=1.08*e.scale.x;t<=3&&(t=3,i=1),e.scale.set(i,i,i),e.position.y=t}else if(this.mouseY>this.mouseMoveY){let t=.02*(this.mouseY-this.mouseMoveY);if(t==e.position.y)return;t=e.position.y+t;let i=.97*e.scale.x;t<=3&&(t=3,i=1),11<=t&&(t=11,i<=.5)&&(i=.5),e.scale.set(i,i,i),e.position.y=t}}this.threeRenderer.render(this.threeScene,this.threeCamera)},animate(){try{let e=0;this.stopStatus?cancelAnimationFrame(this.animationIndex):(this.cannonWorld.fixedStep(),this.threeScene.children.forEach((t=>{"dice"==t.name&&(t.position.copy(this.diceBodyArr[e].position),t.quaternion.copy(this.diceBodyArr[e].quaternion),e+=1)})),this.diceBodyArr.forEach((e=>{e.sleepTick((new Date).getTime())})),this.threeRenderer.render(this.threeScene,this.threeCamera),this.animationIndex=requestAnimationFrame(this.animate))}catch(e){}}}}),(0,i(5440).Z)(t,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"three2 index-page",attrs:{id:"three2"}},[t("button",{on:{click:e.start}},[e._v("start")]),t("audio",{ref:"audio",attrs:{src:e.mp3src}})])}),[],!1,null,"32f6a22e",null).exports)},5452:function(e,t,i){e.exports=i.p+"img/2.a6c829c4.jpg"}}]);